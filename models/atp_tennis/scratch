        select m.start_date,m.tournament,m.team1 as team1,m.team2 as team2,
        m.book_name,
        s.price1 as price1,
        s.price2 as price2,
        s.spread1 as spread1,
        s.spread2 as spread2,
        s.odds1 as odds1,
        s.odds2 as odds2,
        (s.odds1+(1.0-s.odds2))/2.0 as spread_odds_avg,
        coalesce(coalesce(m.betting_date,s.betting_date),t.betting_date) as betting_date,
        m.odds1 as ml_odds1,
        m.odds2 as ml_odds2,
        (m.odds1+(1.0-m.odds2))/2.0 as ml_odds_avg,
        m.price1 as max_price1,
        m.price2 as max_price2,
        t.price1 as totals_price1,
        t.price2 as totals_price2,
        t.over,
        t.under,
        ml_overall_avg.avg_odds as overall_odds_avg
        from atp_tennis_betting_link as m
        left outer join atp_tennis_betting_link_spread  as s
        on ((m.team1,m.team2,m.tournament,m.book_id,m.start_date)=(s.team1,s.team2,s.tournament,s.book_id,s.start_date)
            and s.spread1=-s.spread2)
        left outer join atp_tennis_betting_link_totals as t
        on ((m.team1,m.team2,m.tournament,m.book_id,m.start_date)=(t.team1,t.team2,t.tournament,t.book_id,t.start_date)
            and t.over=t.under)
        left outer join atp_matches_money_line_average as ml_overall_avg
            on ((m.team1,m.team2,m.start_date,m.tournament)=(ml_overall_avg.player_id,ml_overall_avg.opponent_id,ml_overall_avg.start_date,ml_overall_avg.tournament))
        where m.betting_date<=now()::date + interval '30 days' and m.book_name in ('Bovada')
   union all
        select m.start_date,m.tournament,m.team2 as team1,m.team1 as team2,
        m.book_name,
        s.price2 as price1,
        s.price1 as price2,
        s.spread2 as spread1,
        s.spread1 as spread2,
        s.odds2 as odds1,
        s.odds1 as odds2,
        (s.odds2+(1.0-s.odds1))/2.0 as spread_odds_avg,
        coalesce(coalesce(m.betting_date,s.betting_date),t.betting_date) as betting_date,
        m.odds2 as ml_odds1,
        m.odds1 as ml_odds2,
        (m.odds2+(1.0-m.odds1))/2.0 as ml_odds_avg,
        m.price2 as max_price1,
        m.price1 as max_price2,
        t.price1 as totals_price1,
        t.price2 as totals_price2,
        t.over,
        t.under,
        1.0 - ml_overall_avg.avg_odds as overall_odds_avg
        from atp_tennis_betting_link as m
        left outer join atp_tennis_betting_link_spread  as s
        on ((m.team1,m.team2,m.tournament,m.book_id,m.start_date)=(s.team1,s.team2,s.tournament,s.book_id,s.start_date)
            and s.spread1=-s.spread2)
        left outer join atp_tennis_betting_link_totals as t
        on ((m.team1,m.team2,m.tournament,m.book_id,m.start_date)=(t.team1,t.team2,t.tournament,t.book_id,t.start_date)
            and t.over=t.under)
        left outer join atp_matches_money_line_average as ml_overall_avg
            on ((m.team1,m.team2,m.start_date,m.tournament)=(ml_overall_avg.player_id,ml_overall_avg.opponent_id,ml_overall_avg.start_date,ml_overall_avg.tournament))
        where m.betting_date<=now()::date + interval '30 days' and m.book_name in ('Bovada') ;

